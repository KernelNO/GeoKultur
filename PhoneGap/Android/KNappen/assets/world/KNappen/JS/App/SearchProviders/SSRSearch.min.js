var App;(function(n){(function(t){var u=function(){function n(){this.items=[],this.numFound=ko.observable(0)}return n}(),i,r;t.SSRSearchResult=u,i=function(){function n(){this.ssrId=ko.observable(""),this.navnetype=ko.observable(""),this.kommunenavn=ko.observable(""),this.fylkesnavn=ko.observable(""),this.stedsnavn=ko.observable(""),this.pos=null}return n}(),t.SSRSearchItem=i,r=function(){function t(){proj4.defs("EPSG:25832","+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"),proj4.defs("EPSG:25833","+proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs")}return t.prototype.search=function(t,i,r){var u,f;if(!t){log.debug("SSRSearch","Have no place. Search not possible.");return}log.debug("SSRSearch","Searching for: "+t),u=this.placeToSSRURL(t),log.info("SSRSearch","Search URL: "+u),f=$.ajax({url:u,dataType:"xml"}).done(function(t){log.info("SSRSearch","Processing result from: "+u);var e=new proj4.Proj("EPSG:4326"),f=[],o=$(t).find("stedsnavn").each(function(){var t=new n.SearchProviders.SSRSearchItem;t.ssrId($(this).find("ssrId").text()),t.navnetype($(this).find("navnetype").text()),t.kommunenavn($(this).find("kommunenavn").text()),t.fylkesnavn($(this).find("fylkesnavn").text()),t.stedsnavn($(this).find("stedsnavn").text());var r="EPSG:"+($(this).find("epsgKode").text()||"25833"),u=new proj4.Proj(r),i=new proj4.Point(+$(this).find("aust").text(),+$(this).find("nord").text());proj4.transform(u,e,i),t.pos=new System.Models.Position(i.y,i.x),t.ssrId()&&f.push(t)}),r=new n.SearchProviders.SSRSearchResult;r.numFound(t.totaltAntallTreff),r.items=f,i(r)}).fail(function(n,t,i){r(i)}).always(function(){})},t.prototype.placeToSSRURL=function(n){var t="?navn="+encodeURIComponent(n)+"*";return config.ssrURL+t+"&maxAnt=50&tilSosiKoordSyst=4258&eksakteForst=true"},t}(),t.SSRSearch=r})(n.SearchProviders||(n.SearchProviders={}));var t=n.SearchProviders})(App||(App={}))