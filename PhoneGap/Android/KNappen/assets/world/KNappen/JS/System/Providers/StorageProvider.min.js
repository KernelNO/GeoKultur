var System,storageProvider;(function(n){(function(n){var t=function(){function n(){this.changed=""}return n.prototype.getChanged=function(){return moment(this.changed)},n}(),i,r;n.StorageMetaData=t,i=function(){function n(){}return n}(),n.StorageItem=i,r=function(){function n(){this.store=new cache,this.isPhoneGap=!1,this.metaObjectCache={},this.isPhoneGap=compatibilityInfo.isPhoneGap,this.ReInit()}return n.prototype.Load=function(){storageProvider.isPhoneGap&&(startup.loadCountdownMs=2e4,phoneGapProvider.SqlRead("settings"))},n.prototype.setPhoneGap=function(n){this.isPhoneGap=n,this.ReInit()},n.prototype.ReInit=function(){log.debug("StorageProvider","setPhoneGap: Running in PhoneGap (use PhoneGap SQL storage instead of localStorage): "+this.isPhoneGap),this.store=this.isPhoneGap?[]:localStorage},n.prototype.set=function(n,i){var f,e,r,u;this.isPhoneGap&&(f=this.store[n]),this.store[n]=i,e=moment().format("X"),r=new t,r.changed=e,u=serializer.serializeJSObject(r),this.store[n+".meta"]=u,this.isPhoneGap&&f!=i&&phoneGapProvider.SqlSetKey("settings",n,i,u)},n.prototype.setRaw=function(n,t){log.debug("StorageProvider","SQL: setRaw: key: "+n),this.store[n]=t},n.prototype.get=function(n){return this.store[n]},n.prototype.getMeta=function(n){var i=this.metaObjectCache[n];return i||(i=serializer.deserializeJSObject(this.store[n+".meta"],new t),this.metaObjectCache[n]=i),i},n.prototype.remove=function(n){delete this.store[n],delete this.store[n+".meta"],delete this.metaObjectCache.key,this.isPhoneGap&&phoneGapProvider.SqlRemoveKey("settings",n)},n.prototype.getAll=function(){return this.store},n.prototype.has=function(n){return this.store.has(n)},n}(),n.StorageProvider=r})(n.Providers||(n.Providers={}));var t=n.Providers})(System||(System={})),storageProvider=new System.Providers.StorageProvider,startup.addLoad(function(){storageProvider.Load()},"StorageProvider")